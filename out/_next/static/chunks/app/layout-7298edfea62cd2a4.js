(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[558],{15025:(e,r,t)=>{"use strict";t.d(r,{D:()=>g});var n=t(95155),o=t(12115),i=t(23475),s=t(70957),a=t(18956),c=t(50067),l=t(35695),d=t(39605);function u(e){let{children:r}=e,t=(0,l.useRouter)(),i=(0,l.usePathname)();return(0,o.useEffect)(()=>{if(i.includes("/tutor")||i.includes("/teaching-assistant")||i.includes("/login")||i.includes("/signup"))return;let e=(0,d.dn)();e&&(0,d.CJ)(e)&&(console.log("Active guest role detected: ".concat(e,". Redirecting...")),"student"===e?t.replace("/tutor"):"teacher"===e&&t.replace("/teaching-assistant"))},[i,t]),(0,n.jsx)(n.Fragment,{children:r})}function g(e){let{children:r}=e;return(0,n.jsx)(i.O,{children:(0,n.jsx)(s.k,{children:(0,n.jsx)(a.$,{children:(0,n.jsx)(c.I,{children:(0,n.jsx)(u,{children:r})})})})})}},19324:()=>{},20724:(e,r,t)=>{Promise.resolve().then(t.bind(t,41266)),Promise.resolve().then(t.t.bind(t,65688,23)),Promise.resolve().then(t.t.bind(t,39432,23)),Promise.resolve().then(t.t.bind(t,19324,23))},35695:(e,r,t)=>{"use strict";var n=t(18999);t.o(n,"usePathname")&&t.d(r,{usePathname:function(){return n.usePathname}}),t.o(n,"useRouter")&&t.d(r,{useRouter:function(){return n.useRouter}})},39432:e=>{e.exports={style:{fontFamily:"'Geist Mono', 'Geist Mono Fallback'",fontStyle:"normal"},className:"__className_9a8899",variable:"__variable_9a8899"}},41266:(e,r,t)=>{"use strict";t.d(r,{default:()=>u});var n=t(95155),o=t(12115),i=t(15025);let s=async()=>{try{if(!("serviceWorker"in navigator&&"SyncManager"in window))return console.log("Background sync not supported"),!1;{let e=await navigator.serviceWorker.ready;try{if("periodicSync"in e){let r=e.periodicSync,t=await r.register({tag:"periodic-sync-conversations",minInterval:36e5});console.log("Periodic sync registered:",t)}return await e.sync.register("sync-conversations"),console.log("Background sync registered"),!0}catch(e){return console.error("Error registering sync:",e),!1}}}catch(e){return console.error("Error setting up sync:",e),!1}},a=async()=>{if("serviceWorker"in navigator){let e=await navigator.serviceWorker.ready;if(e.sync)try{return await e.sync.register("sync-conversations"),!0}catch(e){console.error("Error triggering sync:",e)}}return!1},c=e=>{"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",r=>{r.data&&"SYNC_COMPLETE"===r.data.type&&e(r.data.count||0)})},l=()=>{window.addEventListener("online",async()=>{console.log("Back online, triggering sync"),await a()})};var d=t(39605);function u(e){let{children:r}=e;return(0,o.useEffect)(()=>{(0,d.QF)()},[]),(0,o.useEffect)(()=>{"serviceWorker"in navigator&&(window.addEventListener("load",async()=>{try{let e=await navigator.serviceWorker.register("/ai/service-worker.js",{scope:"/ai/"});console.log("Service Worker registered with scope:",e.scope),await s(),e.addEventListener("updatefound",()=>{let r=e.installing;r&&r.addEventListener("statechange",()=>{"installed"===r.state&&navigator.serviceWorker.controller&&window.confirm("A new version is available! Would you like to update?")&&(r.postMessage({type:"SKIP_WAITING"}),window.location.reload())})}),c(e=>{if(console.log("Synced ".concat(e," conversations")),e>0){let r=new CustomEvent("sync-complete",{detail:{count:e}});window.dispatchEvent(r)}}),l()}catch(e){console.error("Service Worker registration failed:",e)}}),document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&navigator.serviceWorker.getRegistration().then(e=>{e&&e.update()})}))},[]),(0,n.jsx)(i.D,{children:r})}},51368:(e,r,t)=>{"use strict";let n;t.d(r,{A:()=>a});let o={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},i=new Uint8Array(16),s=[];for(let e=0;e<256;++e)s.push((e+256).toString(16).slice(1));let a=function(e,r,t){if(o.randomUUID&&!r&&!e)return o.randomUUID();let a=(e=e||{}).random??e.rng?.()??function(){if(!n){if("undefined"==typeof crypto||!crypto.getRandomValues)throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");n=crypto.getRandomValues.bind(crypto)}return n(i)}();if(a.length<16)throw Error("Random bytes length must be >= 16");if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,r){if((t=t||0)<0||t+16>r.length)throw RangeError(`UUID byte range ${t}:${t+15} is out of buffer bounds`);for(let e=0;e<16;++e)r[t+e]=a[e];return r}return function(e,r=0){return(s[e[r+0]]+s[e[r+1]]+s[e[r+2]]+s[e[r+3]]+"-"+s[e[r+4]]+s[e[r+5]]+"-"+s[e[r+6]]+s[e[r+7]]+"-"+s[e[r+8]]+s[e[r+9]]+"-"+s[e[r+10]]+s[e[r+11]]+s[e[r+12]]+s[e[r+13]]+s[e[r+14]]+s[e[r+15]]).toLowerCase()}(a)}},65688:e=>{e.exports={style:{fontFamily:"'Geist', 'Geist Fallback'",fontStyle:"normal"},className:"__className_188709",variable:"__variable_188709"}}},e=>{var r=r=>e(e.s=r);e.O(0,[261,428,392,712,441,684,358],()=>r(20724)),_N_E=e.O()}]);